{"version":3,"sources":["app.js"],"sourcesContent":["/**\n * Created D/28/02/2016\n * Updated M/22/03/2022\n *\n * Copyright 2012-2022 | Fabrice Creuzot (luigifab) <code~luigifab~fr>\n * https://www.luigifab.fr/openmage/modules\n *\n * This program is free software, you can redistribute it or modify\n * it under the terms of the GNU General Public License (GPL) as published\n * by the free software foundation, either version 2 of the license, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but without any warranty, without even the implied warranty of\n * merchantability or fitness for a particular purpose. See the\n * GNU General Public License (GPL) for more details.\n */\n\nif (window.NodeList && !NodeList.prototype.forEach) {\n\tNodeList.prototype.forEach = function (callback, that, i) {\n\t\tthat = that || window;\n\t\tfor (i = 0; i < this.length; i++)\n\t\t\tcallback.call(that, this[i], i, this);\n\t};\n}\n\nvar modules = new (function () {\n\n\t\"use strict\";\n\n\tthis.init = function () {\n\n\t\tif (document.querySelector('body.adminhtml-modules-index-index')) {\n\n\t\t\tconsole.info('modules.app - hello');\n\t\t\tvar search, data;\n\n\t\t\t// crée les inputs dans les cellules des entêtes\n\t\t\t// prend soin de supprimer ce qu'il y a dans les th\n\t\t\t// utilise l'id du tableau html\n\t\t\tdocument.querySelectorAll('table.data tr.filter th').forEach(function (elem) {\n\n\t\t\t\twhile (elem.firstChild)\n\t\t\t\t\telem.firstChild.remove();\n\n\t\t\t\tsearch = document.createElement('input');\n\t\t\t\tsearch.setAttribute('type', 'search');\n\t\t\t\tsearch.setAttribute('spellcheck', 'false');\n\t\t\t\tsearch.setAttribute('autocomplete', 'off');\n\t\t\t\tsearch.setAttribute('class', 'input-text');\n\t\t\t\tsearch.setAttribute('oninput', \"modules.action('\" + elem.parentNode.parentNode.parentNode.getAttribute('id') + \"');\");\n\n\t\t\t\telem.appendChild(search);\n\t\t\t});\n\n\t\t\t// réutilise la recherche précédente\n\t\t\tdata = this.storage('modules_search');\n\t\t\tif (data) {\n\t\t\t\tsearch = document.querySelector('div.content-header input[type=\"search\"]');\n\t\t\t\tsearch.value = data;\n\t\t\t\tthis.action(search);\n\t\t\t}\n\t\t}\n\t};\n\n\tthis.filter = function (id) {\n\n\t\tvar words, tmp, text, show, size, cnt;\n\t\tdocument.getElementById(id).querySelectorAll('tbody tr').forEach(function (line) {\n\n\t\t\tshow = [];\n\n\t\t\t// pour chaque colonne (car toutes les colonnes peuvent avoir un filtre)\n\t\t\t// words = ce qu'on cherche dans la colonne courante\n\t\t\t// text  = ce qu'il y a dans la cellule de la colonne de la ligne courante\n\t\t\tdocument.getElementById(id).querySelectorAll('input[type=\"search\"]').forEach(function (col, idx) {\n\n\t\t\t\twords = col.value.toLowerCase().trim(); // ce qu'on cherche\n\n\t\t\t\t// s'il y a des mots\n\t\t\t\tif (words.length > 0) {\n\n\t\t\t\t\twords = words.split(' ');\n\t\t\t\t\tsize  = words.length;\n\t\t\t\t\ttext  = line.querySelectorAll('td')[idx].innerHTML.replace(/<[^>]+>/ig, '').toLowerCase().trim(); // dans quoi on cherche\n\t\t\t\t\tcnt   = 0;\n\n\t\t\t\t\twords.forEach(function (word) {\n\t\t\t\t\t\tif ((word === '-') || (word === '|')) {\n\t\t\t\t\t\t\tsize--;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (word.charAt(0) === '-') {\n\t\t\t\t\t\t\tsize--;\n\t\t\t\t\t\t\tif (text.indexOf(word.substring(1)) > -1)\n\t\t\t\t\t\t\t\tsize = -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (word.indexOf('|') > -1) {\n\t\t\t\t\t\t\ttmp = word.split('|');\n\t\t\t\t\t\t\twhile (tmp.length > 0) {\n\t\t\t\t\t\t\t\tword = tmp.pop();\n\t\t\t\t\t\t\t\tif ((word.length > 0) && (text.indexOf(word) > -1)) {\n\t\t\t\t\t\t\t\t\ttmp = '';\n\t\t\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (text.indexOf(word) > -1) {\n\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tshow.push(cnt === size);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tshow.push(true);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// maintenant que chaque colonne de la ligne a été vérifiée\n\t\t\t// si aucune colonne indique qu'il ne faut pas afficher la ligne, on affiche la ligne\n\t\t\tline.setAttribute('style', (show.indexOf(false) > -1) ? 'display:none;' : '');\n\t\t\tline.removeAttribute('title');\n\t\t});\n\t};\n\n\tthis.action = function (data) {\n\n\t\t// un objet = demande le filtrage de tous les tableaux\n\t\tif (typeof data != 'string') {\n\n\t\t\tif (data.altKey || data.ctrlKey || data.metaKey || data.shiftKey)\n\t\t\t\treturn;\n\n\t\t\tdocument.querySelectorAll('table.data').forEach(function (elem) {\n\t\t\t\telem.querySelector('input[type=\"search\"]').value = data.value;\n\t\t\t\tthis.filter(elem.getAttribute('id'));\n\t\t\t}, this); // pour que ci-dessus this = this\n\n\t\t\tthis.storage('modules_search', data.value);\n\t\t}\n\t\t// un id = demande le filtrage du tableau\n\t\telse if (document.getElementById(data)) {\n\t\t\tthis.filter(data);\n\t\t}\n\t};\n\n\tthis.reset = function (elem) {\n\n\t\tthis.storage('modules_search', null);\n\n\t\t// efface les filtres et les display\n\t\tdocument.querySelectorAll('table.data thead input[type=\"search\"]').forEach(function (elem) { elem.value = ''; });\n\t\tdocument.querySelectorAll('table.data tbody tr[style]').forEach(function (elem) { elem.removeAttribute('style'); });\n\n\t\t// efface le filtre global\n\t\telem = document.querySelector('div.content-header input[type=\"search\"]');\n\t\telem.value = '';\n\t\telem.focus();\n\t};\n\n\tthis.storage = function (key, value) {\n\n\t\t// remove\n\t\tif (value === null) {\n\t\t\tlocalStorage.removeItem(key);\n\t\t\tsessionStorage.removeItem(key);\n\t\t}\n\t\t// set\n\t\telse if (typeof value != 'undefined') {\n\t\t\tlocalStorage.setItem(key, value);\n\t\t\tsessionStorage.setItem(key, value);\n\t\t}\n\t\t// get\n\t\telse {\n\t\t\treturn localStorage.getItem(key) || sessionStorage.getItem(key);\n\t\t}\n\t};\n\n\tthis.unload = function () {\n\t\tthis.storage('modules_search', this.storage('modules_search'));\n\t};\n\n})();\n\nif (typeof self.addEventListener == 'function') {\n\tself.addEventListener('load', modules.init.bind(modules));\n\tself.addEventListener('beforeunload', modules.unload.bind(modules));\n}"],"names":["window","NodeList","prototype","forEach","callback","that","i","this","length","call","modules","init","search","data","document","querySelector","console","info","querySelectorAll","elem","firstChild","remove","createElement","setAttribute","parentNode","getAttribute","appendChild","storage","value","action","filter","id","words","tmp","text","show","size","cnt","getElementById","line","col","idx","toLowerCase","trim","split","innerHTML","replace","word","charAt","indexOf","substring","pop","push","removeAttribute","altKey","ctrlKey","metaKey","shiftKey","reset","focus","key","localStorage","removeItem","sessionStorage","getItem","setItem","unload","self","addEventListener","bind"],"mappings":"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"}