{"version":3,"sources":["app.js"],"sourcesContent":["/**\n * Created D/28/02/2016\n * Updated M/22/03/2022\n *\n * Copyright 2012-2024 | Fabrice Creuzot (luigifab) <code~luigifab~fr>\n * https://github.com/luigifab/openmage-modules\n *\n * This program is free software, you can redistribute it or modify\n * it under the terms of the GNU General Public License (GPL) as published\n * by the free software foundation, either version 2 of the license, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but without any warranty, without even the implied warranty of\n * merchantability or fitness for a particular purpose. See the\n * GNU General Public License (GPL) for more details.\n */\n\nif (window.NodeList && !NodeList.prototype.forEach) {\n\tNodeList.prototype.forEach = function (callback, that, i) {\n\t\tthat = that || window;\n\t\tfor (i = 0; i < this.length; i++)\n\t\t\tcallback.call(that, this[i], i, this);\n\t};\n}\n\nvar modules = new (function () {\n\n\t\"use strict\";\n\n\tthis.init = function () {\n\n\t\tif (document.querySelector('body.adminhtml-modules-index-index')) {\n\n\t\t\tconsole.info('modules.app - hello');\n\t\t\tvar search, data;\n\n\t\t\t// crée les inputs dans les cellules des entêtes\n\t\t\t// prend soin de supprimer ce qu'il y a dans les th\n\t\t\t// utilise l'id du tableau html\n\t\t\tdocument.querySelectorAll('table.data tr.filter th').forEach(function (elem) {\n\n\t\t\t\twhile (elem.firstChild)\n\t\t\t\t\telem.firstChild.remove();\n\n\t\t\t\tsearch = document.createElement('input');\n\t\t\t\tsearch.setAttribute('type', 'search');\n\t\t\t\tsearch.setAttribute('spellcheck', 'false');\n\t\t\t\tsearch.setAttribute('autocomplete', 'off');\n\t\t\t\tsearch.setAttribute('class', 'input-text');\n\t\t\t\tsearch.setAttribute('oninput', \"modules.action('\" + elem.parentNode.parentNode.parentNode.getAttribute('id') + \"');\");\n\n\t\t\t\telem.appendChild(search);\n\t\t\t});\n\n\t\t\t// réutilise la recherche précédente\n\t\t\tdata = this.storage('modules_search');\n\t\t\tif (data) {\n\t\t\t\tsearch = document.querySelector('div.content-header input[type=\"search\"]');\n\t\t\t\tsearch.value = data;\n\t\t\t\tthis.action(search);\n\t\t\t}\n\t\t}\n\t};\n\n\tthis.filter = function (id) {\n\n\t\tvar words, tmp, text, show, size, cnt;\n\t\tdocument.getElementById(id).querySelectorAll('tbody tr').forEach(function (line) {\n\n\t\t\tshow = [];\n\n\t\t\t// pour chaque colonne (car toutes les colonnes peuvent avoir un filtre)\n\t\t\t// words = ce qu'on cherche dans la colonne courante\n\t\t\t// text  = ce qu'il y a dans la cellule de la colonne de la ligne courante\n\t\t\tdocument.getElementById(id).querySelectorAll('input[type=\"search\"]').forEach(function (col, idx) {\n\n\t\t\t\twords = col.value.toLowerCase().trim(); // ce qu'on cherche\n\n\t\t\t\t// s'il y a des mots\n\t\t\t\tif (words.length > 0) {\n\n\t\t\t\t\twords = words.split(' ');\n\t\t\t\t\tsize  = words.length;\n\t\t\t\t\ttext  = line.querySelectorAll('td')[idx].innerHTML.replace(/<[^>]+>/ig, '').toLowerCase().trim(); // dans quoi on cherche\n\t\t\t\t\tcnt   = 0;\n\n\t\t\t\t\twords.forEach(function (word) {\n\t\t\t\t\t\tif ((word === '-') || (word === '|')) {\n\t\t\t\t\t\t\tsize--;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (word.charAt(0) === '-') {\n\t\t\t\t\t\t\tsize--;\n\t\t\t\t\t\t\tif (text.indexOf(word.substring(1)) > -1)\n\t\t\t\t\t\t\t\tsize = -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (word.indexOf('|') > -1) {\n\t\t\t\t\t\t\ttmp = word.split('|');\n\t\t\t\t\t\t\twhile (tmp.length > 0) {\n\t\t\t\t\t\t\t\tword = tmp.pop();\n\t\t\t\t\t\t\t\tif ((word.length > 0) && (text.indexOf(word) > -1)) {\n\t\t\t\t\t\t\t\t\ttmp = '';\n\t\t\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (text.indexOf(word) > -1) {\n\t\t\t\t\t\t\tcnt++;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tshow.push(cnt === size);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tshow.push(true);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// maintenant que chaque colonne de la ligne a été vérifiée\n\t\t\t// si aucune colonne indique qu'il ne faut pas afficher la ligne, on affiche la ligne\n\t\t\tline.setAttribute('style', (show.indexOf(false) > -1) ? 'display:none;' : '');\n\t\t\tline.removeAttribute('title');\n\t\t});\n\t};\n\n\tthis.action = function (data) {\n\n\t\t// un objet = demande le filtrage de tous les tableaux\n\t\tif (typeof data != 'string') {\n\n\t\t\tif (data.altKey || data.ctrlKey || data.metaKey || data.shiftKey)\n\t\t\t\treturn;\n\n\t\t\tdocument.querySelectorAll('table.data').forEach(function (elem) {\n\t\t\t\telem.querySelector('input[type=\"search\"]').value = data.value;\n\t\t\t\tthis.filter(elem.getAttribute('id'));\n\t\t\t}, this); // pour que ci-dessus this = this\n\n\t\t\tthis.storage('modules_search', data.value);\n\t\t}\n\t\t// un id = demande le filtrage du tableau\n\t\telse if (document.getElementById(data)) {\n\t\t\tthis.filter(data);\n\t\t}\n\t};\n\n\tthis.reset = function (elem) {\n\n\t\tthis.storage('modules_search', null);\n\n\t\t// efface les filtres et les display\n\t\tdocument.querySelectorAll('table.data thead input[type=\"search\"]').forEach(function (elem) { elem.value = ''; });\n\t\tdocument.querySelectorAll('table.data tbody tr[style]').forEach(function (elem) { elem.removeAttribute('style'); });\n\n\t\t// efface le filtre global\n\t\telem = document.querySelector('div.content-header input[type=\"search\"]');\n\t\telem.value = '';\n\t\telem.focus();\n\t};\n\n\tthis.storage = function (key, value) {\n\n\t\t// remove\n\t\tif (value === null) {\n\t\t\tlocalStorage.removeItem(key);\n\t\t\tsessionStorage.removeItem(key);\n\t\t}\n\t\t// set\n\t\telse if (typeof value != 'undefined') {\n\t\t\tlocalStorage.setItem(key, value);\n\t\t\tsessionStorage.setItem(key, value);\n\t\t}\n\t\t// get\n\t\telse {\n\t\t\treturn localStorage.getItem(key) || sessionStorage.getItem(key);\n\t\t}\n\t};\n\n\tthis.unload = function () {\n\t\tthis.storage('modules_search', this.storage('modules_search'));\n\t};\n\n})();\n\nif (typeof self.addEventListener == 'function') {\n\tself.addEventListener('load', modules.init.bind(modules));\n\tself.addEventListener('beforeunload', modules.unload.bind(modules));\n}"],"names":["window","NodeList","prototype","forEach","callback","that","i","this","length","call","modules","init","search","data","document","querySelector","console","info","querySelectorAll","elem","firstChild","remove","createElement","setAttribute","parentNode","getAttribute","appendChild","storage","value","action","filter","id","words","tmp","text","show","size","cnt","getElementById","line","col","idx","toLowerCase","trim","split","innerHTML","replace","word","charAt","indexOf","substring","pop","push","removeAttribute","altKey","ctrlKey","metaKey","shiftKey","reset","focus","key","localStorage","removeItem","sessionStorage","getItem","setItem","unload","self","addEventListener","bind"],"mappings":"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"}